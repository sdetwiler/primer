<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>Primer</title>
<meta name="generator" content="MediaWiki 1.26wmf10" />
<link rel="apple-touch-icon" href="/static/apple-touch/wikipedia.png" />
<link rel="shortcut icon" href="/static/favicon/wikipedia.ico" />
<link rel="copyright" href="//creativecommons.org/licenses/by-sa/3.0/" />
<link rel="stylesheet" href="//en.wikipedia.org/w/load.php?debug=false&amp;lang=en&amp;modules=ext.uls.nojs%7Cext.visualEditor.viewPageTarget.noscript%7Cext.wikihiero%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles%7Cwikibase.client.init&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="//en.wikipedia.org/w/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: enwiki:resourceloader:filter:minify-css:7:3904d24a08aa08f6a68dc338f9be277e */</style>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/w/static/1.26wmf10/skins/Vector/csshover.min.htc")}</style><![endif]-->
	<script>
	
	var wwi = {
		title:"World War I",
		url:"https://en.wikipedia.org/wiki/World_War_I",
		
		content: [
			{
				text:"World War I (WWI or WW1), also known as the First World War or the Great War, was a global war centred in Europe that began on 28 July 1914 and lasted until 11 November 1918. More than 9 million combatants and 7 million civilians died as a result of the war, a casualty rate exacerbated by the belligerents' technological and industrial sophistication, and tactical stalemate. It was one of the deadliest conflicts in history, paving the way for major political changes, including revolutions in many of the nations involved.",
				media: [ 
					{
						"url": "https://upload.wikimedia.org/wikipedia/commons/0/09/The_badly_shelled_main_road_to_Bapaume.jpg",
						"contentType":"image/jpeg"
					},
					{
						"url": "https://upload.wikimedia.org/wikipedia/commons/0/0e/AlbatDIII.jpg",
						"contentType":"image/jpeg",
					},
					{
						"url": "https://upload.wikimedia.org/wikipedia/commons/7/7b/Vickers_machine_gun_crew_with_gas_masks.jpg",
						"contentType":"image/jpeg"
					}
				]
			},
			
			{
				text:"The war drew in all the world's economic great powers, assembled in two opposing alliances: the Allies (based on the Triple Entente of the United Kingdom, France and the Russian Empire) and the Central Powers of Germany and Austria-Hungary.",
				media: [
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/4/4f/WWI-re.png",
						"contentType":"image/jpeg"
					}
				]
			},

			{
				text:"Although Italy had also been a member of the Triple Alliance alongside Germany and Austria-Hungary, it did not join the Central Powers, as Austria-Hungary had taken the offensive against the terms of the alliance. These alliances were reorganised and expanded as more nations entered the war: Italy, Japan and the United States joined the Allies, and the Ottoman Empire and Bulgaria the Central Powers. More than 70 million military personnel, including 60 million Europeans, were mobilised in one of the largest wars in history.",
				media: [
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/d/d7/Triple_Alliance.png",
						"contentType":"image/jpeg"
					}
				]
			},

			{
				text:"The trigger for war was the 28 June 1914 assassination of Archduke Franz Ferdinand of Austria, heir to the throne of Austria-Hungary, by Yugoslav nationalist Gavrilo Princip in Sarajevo. This set off a diplomatic crisis when Austria-Hungary delivered an ultimatum to the Kingdom of Serbia, and entangled international alliances formed over the previous decades were invoked. Within weeks, the major powers were at war and the conflict soon spread around the world.",
				media: [
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/e/ea/DC-1914-27-d-Sarajevo-cropped.jpg",
						"contentType":"image/jpeg"
					},
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/f/f6/Gavrilo_princip.jpg",
						"contentType":"image/jpeg"
					}
				]
			},
			
			{
				text:"On 28 July, the Austro-Hungarians declared war on Serbia and subsequently invaded. As Russia mobilised in support of Serbia, Germany invaded neutral Belgium and Luxembourg before moving towards France, leading Britain to declare war on Germany. After the German march on Paris was halted, what became known as the Western Front settled into a battle of attrition, with a trench line that would change little until 1917. Meanwhile, on the Eastern Front, the Russian army was successful against the Austro-Hungarians, but was stopped in its invasion of East Prussia by the Germans. In November 1914, the Ottoman Empire joined the Central Powers, opening fronts in the Caucasus, Mesopotamia and the Sinai. Italy joined the Allies in 1915 and Bulgaria joined the Central Powers in the same year, while Romania joined the Allies in 1916, and the United States joined the Allies in 1917.",
				media: [
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/thumb/0/06/Austro-Hungarian_Monarchy_%281914%29.svg/250px-Austro-Hungarian_Monarchy_%281914%29.svg.png		",
						"contentType":"image/jpeg"
					},
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/EU-Belgium.svg/250px-EU-Belgium.svg.png",
						"contentType":"image/jpeg"
					},
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/f/fa/Cheshire_Regiment_trench_Somme_1916.jpg",
						"contentType":"image/jpeg"
					},
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/6/64/Skoda_305_mm_Model_1911_LOC_War_of_the_Nations.jpg",
						"contentType":"image/jpeg"
					},
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/BattleOfTannenberg1.jpg/300px-BattleOfTannenberg1.jpg",
						"contentType":"image/jpeg"
					},
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Kingdom_of_Romania_%281939%29.svg/250px-Kingdom_of_Romania_%281939%29.svg.png",
						"contentType":"image/jpeg"
					},
				]
			}
			
		],
	};




	var testArticle = {
		title:"Test",
		url:"https://en.wikipedia.org/wiki/World_War_I",
		
		content: [
			{
				text:"One. Two. Three.",
				media: [ 
					{
						"url": "https://upload.wikimedia.org/wikipedia/commons/0/09/The_badly_shelled_main_road_to_Bapaume.jpg",
						"contentType":"image/jpeg"
					},
					{
						"url": "https://upload.wikimedia.org/wikipedia/commons/0/0e/AlbatDIII.jpg",
						"contentType":"image/jpeg",
					},
					{
						"url": "https://upload.wikimedia.org/wikipedia/commons/7/7b/Vickers_machine_gun_crew_with_gas_masks.jpg",
						"contentType":"image/jpeg"
					}
				]
			},
			
			{
				text:"Four.",
				media: [
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/4/4f/WWI-re.png",
						"contentType":"image/jpeg"
					}
				]
			},

			{
				text:"Five",
				media: [
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/d/d7/Triple_Alliance.png",
						"contentType":"image/jpeg"
					}
				]
			},

			{
				text:"six",
				media: [
					{
						"url":"https://upload.wikimedia.org/wikipedia/commons/e/ea/DC-1914-27-d-Sarajevo-cropped.jpg",
						"contentType":"image/jpeg"
					}
				]
			}
		],
		
		
		
		
		
	};


	function chunkText(text)
	{
		var maxLen = 300;
		var chunks = [];
		if(text.length > maxLen)
		{
			var sentences = text.split(".");
			for(var si in sentences)
			{
				var s = sentences[si];
				while(s.length > maxLen)
				{
					var idx = s.lastIndexOf(" ", maxLen);
					if(idx < 0)
					{
						// just hack it up.
						var left = s.substr(0,maxLen);
						s = s.substr(maxLen);
						chunks.push(left);
					}
					else
					{
						var left = s.substr(0, idx)
						s = s.substr(idx);
						chunks.push(left);
					}
				}
				chunks.push(s)
			}
		}
		else
		{
			chunks.push(text);
		}

		return chunks;
	}

	var media = {};
	function addMedia(mediaItem, chunkId)
	{
		media[chunkId] = mediaItem;
	}
	
	function nextChunk(chunkId)
	{
		var image = document.getElementById("image");
		var vector = document.getElementById("vector");
		console.log("nextChunk:" + chunkId);
		if(chunkId in media)
		{
			switch(media[chunkId].contentType)
			{
				case "image/jpeg":
				case "image/png":
					image.src = media[chunkId].url;
					break;
			}
			
		}
	}

	function play(article)
	{
		var heading = document.getElementById("firstHeading");
		heading.innerHTML = article.title;
		var sourceLink = document.getElementById("sourceLink");
		sourceLink.href = article.url;
		var chunkId = 0;
		console.log("play:" + article.title);
		for(var i=0; i<article.content.length; ++i)
		{
			var curr = article.content[i];
			
			var chunks = chunkText(article.content[i].text);
			for(var c in chunks)
			{
				console.log(chunks[c]);
				if(c in curr.media)
				{
					addMedia(curr.media[c], chunkId);
				}


				var msg = new SpeechSynthesisUtterance(chunks[c]);
				msg.chunkId = chunkId;
				msg.addEventListener("start", function(){
					console.log("start");
					nextChunk(this.chunkId);
				}.bind(msg));
				msg.addEventListener("end", function(){
					console.log("end");
				}.bind(msg));
				window.speechSynthesis.speak(msg);
				
				++chunkId;
			}
		}
	}
	
	
	function init()
	{
		
		// play(wwi);
	}
	
	function search()
	{
		var f = document.getElementById("f");
		var q = document.getElementById("q");
		f.style.display = "none";
		var req = new XMLHttpRequest();
		req.onload = function() {
			console.log("onload");
			json = JSON.parse(this.responseText);
			// play(json);
			play(wwi);
		}
		req.open("GET", q.value, true);
		req.send();
		
		
		return false;
	}
	</script>





</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Pioneer_11 skin-vector action-view" onload="init()">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice"><!-- CentralNotice --></div>
			<div class="mw-indicators"></div>
			<h1 id="firstHeading" class="firstHeading" lang="en"><i>Heading</i></h1>
			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub"><a id="sourceLink" href="#">From Wikipedia, the free encyclopedia</a></div>
				<div id="contentSub"></div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
					<p>
<form onsubmit="return search()" id="f">
	Name a topic: <input type="text" id="q">
</form>
						<img id="image" style="max-width:100%; max-height:100%;">
						
					</p>
			</div>
		</div>
	</body>
</html>
